{% extends 'base.html' %}
{% load static %}

{% block title %}Disease Prediction - PMA{% endblock %}

{% block content %}
<style>
    /* Dashboard-consistent styling */
    .dashboard-section {
        background: #fff;
        border-radius: 16px;
        box-shadow: 0 6px 30px rgba(16,24,40,0.06);
        padding: 28px 22px;
        margin-bottom: 28px;
    }
    
    .prediction-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 32px;
        padding-bottom: 20px;
        border-bottom: 1px solid #f1f5f9;
    }
    
    .header-left {
        display: flex;
        align-items: center;
        gap: 18px;
    }
    
    .header-icon {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 48px;
        height: 48px;
        border-radius: 12px;
        background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
        color: #1e40af;
        font-size: 22px;
        box-shadow: 0 4px 12px rgba(16,24,40,0.04);
    }
    
    .page-title {
        font-size: 2.25rem;
        font-weight: 800;
        color: #1e40af;
        margin: 0;
        line-height: 1.05;
        letter-spacing: -0.4px;
    }
    
    .page-subtitle {
        color: #6b7280;
        font-size: 0.95rem;
        margin-top: 6px;
    }
    
    /* Symptom Input Section */
    .symptom-input-section {
        margin-bottom: 28px;
    }
    
    .section-title {
        font-size: 1.25rem;
        font-weight: 700;
        color: #1e293b;
        margin-bottom: 16px;
        display: flex;
        align-items: center;
        gap: 12px;
    }
    
    .section-icon {
        width: 28px;
        height: 28px;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
        color: #1e40af;
        font-size: 14px;
    }
    
    /* Symptom Search */
    .symptom-search {
        position: relative;
        margin-bottom: 20px;
    }
    
    .search-input {
        width: 100%;
        padding: 16px 20px 16px 56px;
        border: 2px solid #e2e8f0;
        border-radius: 12px;
        font-size: 1rem;
        background: #f8fafc;
        transition: all 0.3s ease;
        color: #1e293b;
    }
    
    .search-input:focus {
        outline: none;
        border-color: #1e40af;
        background: #fff;
        box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
    }
    
    .search-icon {
        position: absolute;
        left: 18px;
        top: 50%;
        transform: translateY(-50%);
        color: #64748b;
        font-size: 20px;
    }
    
    /* Symptom Categories */
    .symptom-categories {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        margin-bottom: 24px;
    }
    
    .category-btn {
        padding: 10px 18px;
        border: 2px solid #e2e8f0;
        border-radius: 25px;
        background: #fff;
        color: #64748b;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 0.9rem;
    }
    
    .category-btn:hover {
        border-color: #1e40af;
        color: #1e40af;
        background: #f8fafc;
    }
    
    .category-btn.active {
        background: #1e40af;
        color: #fff;
        border-color: #1e40af;
    }
    
    /* Symptom Grid */
    .symptom-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 12px;
        margin-bottom: 24px;
    }
    
    .symptom-chip {
        background: #f8fafc;
        border: 2px solid #e2e8f0;
        border-radius: 12px;
        padding: 14px 16px;
        cursor: pointer;
        transition: all 0.3s ease;
        text-align: center;
        font-weight: 600;
        color: #64748b;
        position: relative;
        overflow: hidden;
    }
    
    .symptom-chip:hover {
        border-color: #1e40af;
        color: #1e40af;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(30, 64, 175, 0.15);
    }
    
    .symptom-chip.selected {
        background: #1e40af;
        color: #fff;
        border-color: #1e40af;
        transform: translateY(-2px);
        box-shadow: 0 4px 16px rgba(30, 64, 175, 0.25);
    }
    
    .symptom-chip .remove-btn {
        position: absolute;
        top: 6px;
        right: 6px;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.2);
        border: none;
        color: #fff;
        cursor: pointer;
        font-size: 12px;
        display: none;
        align-items: center;
        justify-content: center;
    }
    
    .symptom-chip.selected .remove-btn {
        display: flex;
    }
    
    /* Selected Symptoms Display */
    .selected-symptoms {
        background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
        border: 1px solid #bae6fd;
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 24px;
        min-height: 80px;
    }
    
    .selected-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 12px;
    }
    
    .selected-title {
        font-weight: 700;
        color: #0369a1;
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .selected-count {
        background: #0369a1;
        color: #fff;
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 600;
    }
    
    .selected-list {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
    }
    
    .selected-item {
        background: #0369a1;
        color: #fff;
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 6px;
    }
    
    .remove-selected {
        background: rgba(255, 255, 255, 0.2);
        border: none;
        color: #fff;
        width: 16px;
        height: 16px;
        border-radius: 50%;
        cursor: pointer;
        font-size: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    
    /* Action Buttons */
    .action-buttons {
        display: flex;
        gap: 16px;
        margin-bottom: 28px;
        flex-wrap: wrap;
    }
    
    .btn-predict {
        background: #1e40af;
        color: #fff;
        border: none;
        padding: 16px 32px;
        border-radius: 12px;
        font-weight: 700;
        font-size: 1rem;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 12px;
        box-shadow: 0 4px 16px rgba(30, 64, 175, 0.2);
    }
    
    .btn-predict:hover {
        background: #1e3a8a;
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(30, 64, 175, 0.3);
    }
    
    .btn-predict:disabled {
        background: #94a3b8;
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
    }
    
    .btn-clear {
        background: #fff;
        color: #64748b;
        border: 2px solid #e2e8f0;
        padding: 16px 24px;
        border-radius: 12px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .btn-clear:hover {
        border-color: #cbd5e1;
        color: #475569;
        transform: translateY(-1px);
    }
    
    /* Loading State */
    .loading-container {
        display: none;
        text-align: center;
        padding: 40px 20px;
    }
    
    .loading-spinner {
        width: 50px;
        height: 50px;
        border: 4px solid #e2e8f0;
        border-top: 4px solid #1e40af;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto 20px;
    }
    
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
    
    .loading-text {
        font-size: 1.2rem;
        font-weight: 600;
        color: #1e293b;
        margin-bottom: 8px;
    }
    
    .loading-subtitle {
        color: #64748b;
    }
    
    /* Results Section */
    .results-container {
        display: none;
        animation: fadeInUp 0.6s ease;
    }
    
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    .result-card {
        background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
        border: 1px solid #bbf7d0;
        border-radius: 16px;
        padding: 28px;
        margin-bottom: 24px;
        text-align: center;
    }
    
    .result-disease {
        font-size: 2rem;
        font-weight: 800;
        color: #166534;
        margin-bottom: 12px;
    }
    
    .confidence-badge {
        display: inline-block;
        background: #059669;
        color: #fff;
        padding: 8px 20px;
        border-radius: 25px;
        font-weight: 600;
        margin-bottom: 24px;
    }
    
    /* Recommendations Grid */
    .recommendations-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-top: 28px;
    }
    
    .recommendation-card {
        background: #fff;
        border-radius: 12px;
        box-shadow: 0 4px 18px rgba(16,24,40,0.04);
        padding: 24px;
        border: 1px solid #f1f5f9;
        transition: transform 0.3s ease;
    }
    
    .recommendation-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 25px rgba(16,24,40,0.08);
    }
    
    .rec-header {
        display: flex;
        align-items: center;
        margin-bottom: 16px;
    }
    
    .rec-icon {
        width: 40px;
        height: 40px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 18px;
        margin-right: 12px;
    }
    
    .rec-icon.diet {
        background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
        color: #d97706;
    }
    
    .rec-icon.avoid {
        background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
        color: #dc2626;
    }
    
    .rec-icon.hydration {
        background: linear-gradient(135deg, #cffafe 0%, #a7f3d0 100%);
        color: #0891b2;
    }
    
    .rec-icon.notes {
        background: linear-gradient(135deg, #e0e7ff 0%, #c7d2fe 100%);
        color: #4338ca;
    }
    
    .rec-title {
        font-size: 1.1rem;
        font-weight: 700;
        color: #1e293b;
        margin: 0;
    }
    
    .rec-content {
        color: #475569;
        line-height: 1.6;
        font-size: 0.95rem;
    }
    
    .rec-list {
        list-style: none;
        padding: 0;
        margin: 0;
    }
    
    .rec-list li {
        padding: 8px 0;
        border-bottom: 1px solid #f1f5f9;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .rec-list li:last-child {
        border-bottom: none;
    }
    
    .rec-list li::before {
        content: '•';
        color: #059669;
        font-weight: bold;
        font-size: 1.2rem;
    }
    
    /* Recent Predictions */
    .recent-predictions {
        margin-top: 32px;
    }
    
    .prediction-history-item {
        background: #f8fafc;
        border: 1px solid #e2e8f0;
        border-radius: 8px;
        padding: 16px;
        margin-bottom: 12px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    
    .history-disease {
        font-weight: 600;
        color: #1e293b;
    }
    
    .history-date {
        color: #64748b;
        font-size: 0.85rem;
    }
    
    /* Mobile Responsive */
    @media (max-width: 768px) {
        .prediction-header {
            flex-direction: column;
            align-items: flex-start;
            gap: 16px;
        }
        
        .page-title {
            font-size: 1.8rem;
        }
        
        .symptom-categories {
            justify-content: center;
        }
        
        .symptom-grid {
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        }
        
        .action-buttons {
            flex-direction: column;
        }
        
        .btn-predict, .btn-clear {
            width: 100%;
            justify-content: center;
        }
        
        .recommendations-grid {
            grid-template-columns: 1fr;
        }
    }
    
    /* Success Animation */
    .success-animation {
        animation: bounce 0.6s ease;
    }
    
    @keyframes bounce {
        0%, 20%, 53%, 80%, 100% {
            transform: translate3d(0,0,0);
        }
        40%, 43% {
            transform: translate3d(0,-30px,0);
        }
        70% {
            transform: translate3d(0,-15px,0);
        }
        90% {
            transform: translate3d(0,-4px,0);
        }
    }
</style>

<div class="max-w-6xl mx-auto">
    <!-- Header Section -->
    <div class="dashboard-section">
        <div class="prediction-header">
            <div class="header-left">
                <div class="header-icon">
                    <i class='bx bx-brain'></i>
                </div>
                <div>
                    <h1 class="page-title">Disease Prediction</h1>
                    <p class="page-subtitle">AI-powered health analysis using Random Forest Machine Learning</p>
                </div>
            </div>
            <div class="header-right">
                <div class="text-right text-sm text-gray-500">
                    <div class="font-semibold text-primary">Powered by AI</div>
                    <div>Random Forest Classifier</div>
                </div>
            </div>
        </div>

        <!-- Symptom Input Section -->
        <div class="symptom-input-section">
            <h2 class="section-title">
                <div class="section-icon">
                    <i class='bx bx-list-ul'></i>
                </div>
                Select Your Symptoms
            </h2>

            <!-- Search Input -->
            <div class="symptom-search">
                <i class='bx bx-search search-icon'></i>
                <input type="text" class="search-input" id="symptomSearch" placeholder="Search symptoms (e.g., fever, headache, cough...)">
            </div>

            <!-- Categories -->
            <div class="symptom-categories">
                <button class="category-btn active" data-category="all">
                    <i class='bx bx-grid-alt'></i>
                    All Symptoms
                </button>
                <button class="category-btn" data-category="general">
                    <i class='bx bx-body'></i>
                    General
                </button>
                <button class="category-btn" data-category="respiratory">
                    <i class='bx bx-wind'></i>
                    Respiratory
                </button>
                <button class="category-btn" data-category="digestive">
                    <i class='bx bx-food-menu'></i>
                    Digestive
                </button>
                <button class="category-btn" data-category="neurological">
                    <i class='bx bx-brain'></i>
                    Neurological
                </button>
            </div>

            <!-- Selected Symptoms Display -->
            <div class="selected-symptoms" id="selectedSymptomsContainer">
                <div class="selected-header">
                    <div class="selected-title">
                        <i class='bx bx-check-circle'></i>
                        Selected Symptoms
                    </div>
                    <div class="selected-count" id="symptomCount">0 selected</div>
                </div>
                <div class="selected-list" id="selectedSymptomsList">
                    <div style="color: #64748b; font-style: italic;">No symptoms selected yet. Click on symptoms below to add them.</div>
                </div>
            </div>

            <!-- Symptom Grid -->
            <div class="symptom-grid" id="symptomGrid">
                <!-- Symptoms will be populated here -->
            </div>

            <!-- Action Buttons -->
            <div class="action-buttons">
                <button class="btn-predict" id="predictBtn" onclick="predictDisease()" disabled>
                    <i class='bx bx-brain'></i>
                    <span id="predictBtnText">Predict Disease</span>
                </button>
                <button class="btn-clear" onclick="clearSymptoms()">
                    <i class='bx bx-refresh'></i>
                    Clear All
                </button>
            </div>
        </div>
    </div>

    <!-- Loading State -->
    <div class="dashboard-section loading-container" id="loadingContainer">
        <div class="loading-spinner"></div>
        <div class="loading-text">Analyzing Your Symptoms...</div>
        <div class="loading-subtitle">Our AI is processing your symptoms using Random Forest algorithm</div>
    </div>

    <!-- Results Section -->
    <div class="dashboard-section results-container" id="resultsContainer">
        <h2 class="section-title">
            <div class="section-icon">
                <i class='bx bx-check-circle'></i>
            </div>
            Prediction Results
        </h2>

        <div class="result-card">
            <div class="result-disease" id="predictedDisease">Common Cold</div>
            <div class="confidence-badge" id="confidenceBadge">
                <i class='bx bx-check-circle'></i>
                <span id="confidenceScore">85% confidence</span>
            </div>
            <p style="color: #059669; font-weight: 600; margin: 0;">
                Based on your symptoms, this is our AI's best prediction. Please consult a healthcare professional for proper diagnosis.
            </p>
        </div>

        <!-- Recommendations Grid -->
        <div class="recommendations-grid">
            <!-- Recommended Diet -->
            <div class="recommendation-card">
                <div class="rec-header">
                    <div class="rec-icon diet">
                        <i class='bx bx-restaurant'></i>
                    </div>
                    <h3 class="rec-title">Recommended Diet</h3>
                </div>
                <div class="rec-content" id="dietRecommendations">
                    <ul class="rec-list">
                        <li>Vitamin C rich foods (oranges, kiwi, bell peppers)</li>
                        <li>Warm soups and broths</li>
                        <li>Ginger and honey tea</li>
                        <li>Light, easily digestible meals</li>
                    </ul>
                </div>
            </div>

            <!-- Foods to Avoid -->
            <div class="recommendation-card">
                <div class="rec-header">
                    <div class="rec-icon avoid">
                        <i class='bx bx-x-circle'></i>
                    </div>
                    <h3 class="rec-title">Foods to Avoid</h3>
                </div>
                <div class="rec-content" id="avoidRecommendations">
                    <ul class="rec-list">
                        <li>Dairy products (may increase mucus)</li>
                        <li>Processed and fried foods</li>
                        <li>Excessive sugar and sweets</li>
                        <li>Alcohol and caffeinated drinks</li>
                    </ul>
                </div>
            </div>

            <!-- Hydration -->
            <div class="recommendation-card">
                <div class="rec-header">
                    <div class="rec-icon hydration">
                        <i class='bx bx-droplet'></i>
                    </div>
                    <h3 class="rec-title">Hydration Guidance</h3>
                </div>
                <div class="rec-content" id="hydrationGuidance">
                    <ul class="rec-list">
                        <li>Drink 8-10 glasses of water daily</li>
                        <li>Warm water with lemon and honey</li>
                        <li>Herbal teas (chamomile, ginger)</li>
                        <li>Avoid cold drinks</li>
                    </ul>
                </div>
            </div>

            <!-- Medical Notes -->
            <div class="recommendation-card">
                <div class="rec-header">
                    <div class="rec-icon notes">
                        <i class='bx bx-notepad'></i>
                    </div>
                    <h3 class="rec-title">Important Notes</h3>
                </div>
                <div class="rec-content" id="medicalNotes">
                    <ul class="rec-list">
                        <li>Rest and get adequate sleep</li>
                        <li>Monitor temperature regularly</li>
                        <li>Consult a doctor if symptoms worsen</li>
                        <li>This is AI prediction, not medical diagnosis</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Additional Actions -->
        <div class="action-buttons" style="justify-content: center; margin-top: 28px;">
            <button class="btn-predict" onclick="bookAppointment()" style="background: #059669;">
                <i class='bx bx-calendar-plus'></i>
                Book Appointment
            </button>
            <button class="btn-clear" onclick="newPrediction()">
                <i class='bx bx-refresh'></i>
                New Prediction
            </button>
        </div>
    </div>

    <!-- Recent Predictions -->
    {% if recent_predictions %}
    <div class="dashboard-section recent-predictions">
        <h2 class="section-title">
            <div class="section-icon">
                <i class='bx bx-history'></i>
            </div>
            Recent Predictions
        </h2>
        
        {% for prediction in recent_predictions %}
        <div class="prediction-history-item">
            <div>
                <div class="history-disease">{{ prediction.predicted_disease }}</div>
                <div class="history-date">{{ prediction.created_at|date:"M d, Y at H:i" }}</div>
            </div>
            <div class="confidence-badge" style="font-size: 0.8rem; padding: 4px 12px;">
                {{ prediction.confidence_score|floatformat:0 }}%
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}
</div>

<script>
// Symptom database with categories
const symptomsDatabase = {
    general: [
        'Fever', 'Fatigue', 'Chills', 'Body aches', 'Sweating', 'Weight loss', 'Weight gain', 'Loss of appetite'
    ],
    respiratory: [
        'Cough', 'Shortness of breath', 'Chest pain', 'Sore throat', 'Runny nose', 'Congestion', 'Sneezing', 'Wheezing'
    ],
    digestive: [
        'Nausea', 'Vomiting', 'Diarrhea', 'Constipation', 'Abdominal pain', 'Bloating', 'Heartburn', 'Gas'
    ],
    neurological: [
        'Headache', 'Dizziness', 'Confusion', 'Memory problems', 'Seizures', 'Numbness', 'Tingling', 'Vision changes'
    ]
};

// Global variables
let selectedSymptoms = [];

// Initialize the page
document.addEventListener('DOMContentLoaded', function() {
    loadSymptoms('all');
    setupEventListeners();
});

// Setup event listeners
function setupEventListeners() {
    // Category buttons
    document.querySelectorAll('.category-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            // Update active category
            document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            
            // Load symptoms for category
            loadSymptoms(this.dataset.category);
        });
    });

    // Search functionality
    document.getElementById('symptomSearch').addEventListener('input', function(e) {
        const searchTerm = e.target.value.toLowerCase();
        filterSymptoms(searchTerm);
    });
}

// Load symptoms based on category
function loadSymptoms(category) {
    const symptomGrid = document.getElementById('symptomGrid');
    symptomGrid.innerHTML = '';
    
    let symptomsToShow = [];
    if (category === 'all') {
        Object.values(symptomsDatabase).forEach(categorySymptoms => {
            symptomsToShow = symptomsToShow.concat(categorySymptoms);
        });
    } else {
        symptomsToShow = symptomsDatabase[category] || [];
    }
    
    symptomsToShow.forEach(symptom => {
        const symptomChip = createSymptomChip(symptom);
        symptomGrid.appendChild(symptomChip);
    });
}

// Create symptom chip element
function createSymptomChip(symptom) {
    const chip = document.createElement('div');
    chip.className = 'symptom-chip';
    chip.textContent = symptom;
    
    // Add remove button
    const removeBtn = document.createElement('button');
    removeBtn.className = 'remove-btn';
    removeBtn.innerHTML = '×';
    removeBtn.onclick = (e) => {
        e.stopPropagation();
        toggleSymptom(symptom, chip);
    };
    chip.appendChild(removeBtn);
    
    // Add click handler
    chip.addEventListener('click', () => toggleSymptom(symptom, chip));
    
    // Check if already selected
    if (selectedSymptoms.includes(symptom)) {
        chip.classList.add('selected');
    }
    
    return chip;
}

// Toggle symptom selection
function toggleSymptom(symptom, chipElement) {
    const index = selectedSymptoms.indexOf(symptom);
    
    if (index === -1) {
        // Add symptom
        selectedSymptoms.push(symptom);
        chipElement.classList.add('selected');
    } else {
        // Remove symptom
        selectedSymptoms.splice(index, 1);
        chipElement.classList.remove('selected');
    }
    
    updateSelectedDisplay();
    updatePredictButton();
}

// Update selected symptoms display
function updateSelectedDisplay() {
    const container = document.getElementById('selectedSymptomsList');
    const countElement = document.getElementById('symptomCount');
    
    countElement.textContent = `${selectedSymptoms.length} selected`;
    
    if (selectedSymptoms.length === 0) {
        container.innerHTML = '<div style="color: #64748b; font-style: italic;">No symptoms selected yet. Click on symptoms below to add them.</div>';
        return;
    }
    
    container.innerHTML = selectedSymptoms.map(symptom => `
        <div class="selected-item">
            ${symptom}
            <button class="remove-selected" onclick="removeSelectedSymptom('${symptom}')">×</button>
        </div>
    `).join('');
}

// Remove selected symptom
function removeSelectedSymptom(symptom) {
    const index = selectedSymptoms.indexOf(symptom);
    if (index !== -1) {
        selectedSymptoms.splice(index, 1);
        
        // Update chip appearance
        const chips = document.querySelectorAll('.symptom-chip');
        chips.forEach(chip => {
            if (chip.textContent.trim().replace('×', '') === symptom) {
                chip.classList.remove('selected');
            }
        });
        
        updateSelectedDisplay();
        updatePredictButton();
    }
}

// Update predict button state
function updatePredictButton() {
    const predictBtn = document.getElementById('predictBtn');
    predictBtn.disabled = selectedSymptoms.length === 0;
}

// Filter symptoms based on search
function filterSymptoms(searchTerm) {
    const chips = document.querySelectorAll('.symptom-chip');
    chips.forEach(chip => {
        const symptomName = chip.textContent.replace('×', '').toLowerCase();
        if (symptomName.includes(searchTerm)) {
            chip.style.display = 'block';
        } else {
            chip.style.display = 'none';
        }
    });
}

// Clear all symptoms
function clearSymptoms() {
    selectedSymptoms = [];
    document.querySelectorAll('.symptom-chip').forEach(chip => {
        chip.classList.remove('selected');
    });
    updateSelectedDisplay();
    updatePredictButton();
    
    // Clear search
    document.getElementById('symptomSearch').value = '';
    filterSymptoms('');
}

// Predict disease
async function predictDisease() {
    if (selectedSymptoms.length === 0) {
        alert('Please select at least one symptom.');
        return;
    }
    
    // Show loading state
    showLoading();
    
    try {
        const response = await fetch('/patients/predict-disease/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': getCookie('csrftoken')
            },
            body: JSON.stringify({
                symptoms: selectedSymptoms
            })
        });
        
        const result = await response.json();
        
        if (response.ok) {
            setTimeout(() => {
                hideLoading();
                showResults(result);
            }, 2000); // Show loading for 2 seconds for better UX
        } else {
            throw new Error(result.error || 'Prediction failed');
        }
    } catch (error) {
        console.error('Prediction error:', error);
        hideLoading();
        alert('Sorry, there was an error analyzing your symptoms. Please try again.');
    }
}

// Show loading state
function showLoading() {
    document.getElementById('loadingContainer').style.display = 'block';
    document.getElementById('resultsContainer').style.display = 'none';
    
    // Update predict button
    const predictBtn = document.getElementById('predictBtn');
    const btnText = document.getElementById('predictBtnText');
    predictBtn.disabled = true;
    btnText.textContent = 'Analyzing...';
}

// Hide loading state
function hideLoading() {
    document.getElementById('loadingContainer').style.display = 'none';
    
    // Reset predict button
    const predictBtn = document.getElementById('predictBtn');
    const btnText = document.getElementById('predictBtnText');
    predictBtn.disabled = false;
    btnText.textContent = 'Predict Disease';
}

// Show results
function showResults(result) {
    const resultsContainer = document.getElementById('resultsContainer');
    resultsContainer.style.display = 'block';
    resultsContainer.classList.add('success-animation');
    
    // Update disease prediction
    document.getElementById('predictedDisease').textContent = result.predicted_disease || 'Unknown Condition';
    
    // Update confidence
    const confidence = Math.round((result.confidence || 0) * 100);
    document.getElementById('confidenceScore').textContent = `${confidence}% confidence`;
    
    // Update confidence badge color
    const badge = document.getElementById('confidenceBadge');
    if (confidence >= 80) {
        badge.style.background = '#059669';
    } else if (confidence >= 60) {
        badge.style.background = '#d97706';
    } else {
        badge.style.background = '#dc2626';
    }
    
    // Update recommendations
    updateRecommendations(result);
    
    // Scroll to results
    resultsContainer.scrollIntoView({ behavior: 'smooth' });
}

// Update recommendations based on result
function updateRecommendations(result) {
    // Diet recommendations
    if (result.recommended_diet) {
        document.getElementById('dietRecommendations').innerHTML = `<p>${result.recommended_diet}</p>`;
    }
    
    // Update other recommendations based on disease type
    const disease = (result.predicted_disease || '').toLowerCase();
    
    // Default recommendations can be customized based on the disease
    // For now, keeping the default ones as they are general health advice
}

// Utility function to get CSRF token
function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}

// Book appointment function
function bookAppointment() {
    window.location.href = '/patients/appointments/book/';
}

// New prediction function
function newPrediction() {
    // Hide results
    document.getElementById('resultsContainer').style.display = 'none';
    
    // Clear symptoms
    clearSymptoms();
    
    // Scroll to top
    window.scrollTo({ top: 0, behavior: 'smooth' });
}
</script>

{% endblock %}
        opacity: 0.95;
        max-width: 700px;
        margin: 0 auto 35px;
        line-height: 1.6;
        font-weight: 300;
        position: relative;
        z-index: 2;
    }

    .hero-features {
        display: flex;
        justify-content: center;
        gap: 35px;
        flex-wrap: wrap;
        margin-top: 35px;
        position: relative;
        z-index: 2;
    }

    .hero-feature {
        display: flex;
        align-items: center;
        gap: 10px;
        font-size: 1rem;
        color: rgba(255, 255, 255, 0.9);
        background: rgba(255, 255, 255, 0.1);
        padding: 12px 20px;
        border-radius: 25px;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        transition: all 0.3s ease;
    }

    .hero-feature:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: translateY(-2px);
    }

    .hero-feature i {
        color: #dbeafe;
        font-size: 1.1rem;
    }

    /* Clean Modern Card */
    .prediction-card {
        max-width: 1200px;
        margin: -50px auto 50px;
        background: white;
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(16, 24, 40, 0.08);
        overflow: hidden;
        border: 1px solid #e2e8f0;
    }

    /* Modern Progress Steps */
    .step-progress {
        display: flex;
        background: #f8fafc;
        border-bottom: 1px solid #e2e8f0;
    }

    .progress-step {
        flex: 1;
        padding: 25px 20px;
        text-align: center;
        position: relative;
        transition: all 0.3s ease;
        cursor: pointer;
        border-right: 1px solid #e2e8f0;
    }

    .progress-step:last-child {
        border-right: none;
    }

    .progress-step.active {
        background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
        color: #1e40af;
    }

    .progress-step.completed {
        background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);
        color: #059669;
    }

    .step-number {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: #e2e8f0;
        font-weight: 700;
        margin-bottom: 10px;
        font-size: 1rem;
        border: 2px solid transparent;
        transition: all 0.3s ease;
        color: #64748b;
    }

    .progress-step.active .step-number {
        background: #1e40af;
        border-color: #1e40af;
        color: white;
        box-shadow: 0 4px 12px rgba(30, 64, 175, 0.3);
    }

    .progress-step.completed .step-number {
        background: #059669;
        border-color: #059669;
        color: white;
        box-shadow: 0 4px 12px rgba(5, 150, 105, 0.3);
    }

    .step-title {
        font-weight: 600;
        font-size: 0.9rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        color: #64748b;
        transition: color 0.3s ease;
    }

    .progress-step.active .step-title,
    .progress-step.completed .step-title {
        color: inherit;
    }

    /* Clean Content Sections */
    .step-content {
        display: none;
        padding: 40px;
        min-height: 550px;
        background: white;
    }

    .step-content.active {
        display: block;
    }

    .content-header {
        text-align: center;
        margin-bottom: 35px;
    }

    .content-title {
        font-size: 2rem;
        font-weight: 800;
        color: #1e40af;
        margin-bottom: 10px;
        letter-spacing: -0.5px;
    }

    .content-description {
        color: #64748b;
        font-size: 1.1rem;
        max-width: 650px;
        margin: 0 auto;
        line-height: 1.6;
        font-weight: 400;
    }

    /* Clean Patient Info */
    .patient-info-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 25px;
        max-width: 800px;
        margin: 0 auto;
    }

    .info-field {
        display: flex;
        flex-direction: column;
        gap: 10px;
    }

    .info-field label {
        font-weight: 600;
        color: #374151;
        font-size: 0.9rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .info-field input,
    .info-field select {
        padding: 16px 20px;
        border: 2px solid #e5e7eb;
        border-radius: 12px;
        font-size: 1rem;
        background: #f9fafb;
        color: #1f2937;
        transition: all 0.3s ease;
        font-weight: 500;
    }

    .info-field input:focus,
    .info-field select:focus {
        outline: none;
        border-color: #1e40af;
        background: white;
        box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
    }

    .info-field input::placeholder {
        color: #9ca3af;
    }

    /* Clean Symptoms Container */
    .symptoms-container {
        max-width: 1100px;
        margin: 0 auto;
    }

    .symptom-search {
        position: relative;
        margin-bottom: 30px;
        max-width: 500px;
        margin-left: auto;
        margin-right: auto;
    }

    .symptom-search input {
        width: 100%;
        padding: 16px 20px 16px 50px;
        border: 2px solid #e5e7eb;
        border-radius: 12px;
        font-size: 1rem;
        background: #f9fafb;
        color: #1f2937;
        transition: all 0.3s ease;
    }

    .symptom-search input:focus {
        outline: none;
        border-color: #1e40af;
        background: white;
        box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
    }

    .symptom-search input::placeholder {
        color: #9ca3af;
    }

    .symptom-search i {
        position: absolute;
        left: 18px;
        top: 50%;
        transform: translateY(-50%);
        color: #6b7280;
        font-size: 1.1rem;
    }

    .symptom-categories {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 20px;
        padding: 10px 0;
    }

    .symptom-category {
        background: white;
        border: 1px solid #e2e8f0;
        border-radius: 16px;
        padding: 20px;
        transition: all 0.3s ease;
        box-shadow: 0 2px 8px rgba(16, 24, 40, 0.04);
    }

    .symptom-category:hover {
        transform: translateY(-2px);
        border-color: #1e40af;
        box-shadow: 0 8px 25px rgba(30, 64, 175, 0.15);
    }

    .category-header {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 16px;
        padding-bottom: 12px;
        border-bottom: 1px solid #e2e8f0;
    }

    .category-icon {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 42px;
        height: 42px;
        border-radius: 12px;
        font-size: 1.2rem;
    }

    .category-icon.respiratory {
        background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
        color: #1e40af;
    }

    .category-icon.gastrointestinal {
        background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);
        color: #059669;
    }

    .category-icon.neurological {
        background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
        color: #d97706;
    }

    .category-icon.skin {
        background: linear-gradient(135deg, #cffafe 0%, #a7f3d0 100%);
        color: #0891b2;
    }

    .category-icon.general {
        background: linear-gradient(135deg, #e0e7ff 0%, #c7d2fe 100%);
        color: #6366f1;
    }

    .category-icon.musculoskeletal {
        background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%);
        color: #be185d;
    }

    .category-icon.urinary {
        background: linear-gradient(135deg, #fed7d7 0%, #feb2b2 100%);
        color: #dc2626;
    }

    .category-icon.mental {
        background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
        color: #374151;
    }

    .category-title {
        font-weight: 700;
        color: #1e293b;
        font-size: 1rem;
        letter-spacing: 0.3px;
    }

    .symptom-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 10px;
    }

    .symptom-option {
        background: #f8fafc;
        border: 2px solid #e5e7eb;
        border-radius: 10px;
        padding: 12px 8px;
        text-align: center;
        cursor: pointer;
        transition: all 0.2s ease;
        font-size: 0.85rem;
        font-weight: 500;
        color: #374151;
    }

    .symptom-option:hover {
        border-color: #1e40af;
        background: #eff6ff;
        transform: translateY(-1px);
    }

    .symptom-option.selected {
        background: #1e40af;
        border-color: #1e40af;
        color: white;
        font-weight: 600;
        box-shadow: 0 4px 12px rgba(30, 64, 175, 0.3);
    }

    /* Clean Selected Symptoms Section */
    .selected-symptoms {
        margin-top: 30px;
        padding: 25px;
        background: white;
        border-radius: 16px;
        border: 1px solid #e2e8f0;
        box-shadow: 0 4px 16px rgba(16, 24, 40, 0.08);
    }

    .selected-title {
        font-weight: 700;
        color: #1e293b;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 12px;
        font-size: 1.1rem;
    }

    .selected-title i {
        color: #1e40af;
    }

    .selected-list {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
    }

    .selected-symptom {
        background: #eff6ff;
        color: #1e40af;
        border: 1px solid #dbeafe;
        padding: 8px 16px;
        border-radius: 20px;
        font-size: 0.9rem;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 8px;
        transition: all 0.3s ease;
    }

    .selected-symptom:hover {
        background: #dbeafe;
        border-color: #1e40af;
        transform: translateY(-1px);
    }

    .selected-symptom .remove {
        cursor: pointer;
        font-weight: 900;
        margin-left: 6px;
        transition: color 0.2s ease;
        font-size: 1.1rem;
        color: #ef4444;
    }

    .selected-symptom .remove:hover {
        color: #dc2626;
        background: #fee2e2;
        border-radius: 50%;
        width: 16px;
        height: 16px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    /* Clean Results Section */
    .results-container {
        max-width: 1000px;
        margin: 0 auto;
    }

    .prediction-result {
        background: white;
        border: 1px solid #e2e8f0;
        border-radius: 20px;
        padding: 40px;
        text-align: center;
        margin-bottom: 30px;
        box-shadow: 0 8px 32px rgba(16, 24, 40, 0.1);
    }

    .result-icon {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        background: linear-gradient(135deg, #1e40af, #3b82f6);
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 2.5rem;
        margin: 0 auto 20px;
        box-shadow: 0 8px 25px rgba(30, 64, 175, 0.3);
    }

    .result-title {
        font-size: 1.4rem;
        font-weight: 700;
        color: #1e40af;
        margin-bottom: 12px;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .result-disease {
        font-size: 2.5rem;
        font-weight: 900;
        color: #dc2626;
        margin-bottom: 15px;
        letter-spacing: -1px;
        text-transform: uppercase;
    }

    .result-confidence {
        font-size: 1.2rem;
        color: #cbd5e1;
        margin-bottom: 25px;
        font-weight: 500;
    }

    .recommendations {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 25px;
        margin-top: 30px;
    }

    .recommendation-card {
        background: rgba(0, 0, 0, 0.4);
        backdrop-filter: blur(15px);
        border-radius: 20px;
        padding: 25px;
        border: 1px solid rgba(255, 255, 255, 0.1);
        text-align: left;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }

    .recommendation-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: linear-gradient(90deg, var(--rec-color), var(--rec-secondary));
        transition: height 0.3s ease;
    }

    .recommendation-card:hover {
        transform: translateY(-5px);
        border-color: rgba(255, 255, 255, 0.2);
        box-shadow: 0 15px 50px rgba(0, 0, 0, 0.3);
    }

    .recommendation-card:hover::before {
        height: 6px;
    }

    .recommendation-header {
        display: flex;
        align-items: center;
        gap: 15px;
        margin-bottom: 15px;
    }

    .recommendation-icon {
        width: 45px;
        height: 45px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.3rem;
        position: relative;
        overflow: hidden;
    }

    .recommendation-icon::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, var(--rec-color), var(--rec-secondary));
        border-radius: 12px;
    }

    .recommendation-icon i {
        position: relative;
        z-index: 2;
        color: #000;
        text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
    }

    .medicine-icon {
        --rec-color: #ffd60a;
        --rec-secondary: #ffbe0b;
    }

    .diet-icon {
        --rec-color: #06ffa5;
        --rec-secondary: #00d4aa;
    }

    .recommendation-title {
        font-weight: 800;
        color: #e2e8f0;
        font-size: 1rem;
        text-transform: uppercase;
        letter-spacing: 1px;
        text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
    }

    .recommendation-content {
        color: #94a3b8;
        line-height: 1.6;
        font-weight: 400;
        font-size: 0.95rem;
    }

    /* Cyberpunk Navigation */
    .step-navigation {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 25px 40px;
        background: rgba(0, 0, 0, 0.6);
        backdrop-filter: blur(20px);
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        position: relative;
    }

    .step-navigation::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 1px;
        background: linear-gradient(90deg, transparent, #00ff88, #00bfff, #ff0080, transparent);
        animation: topBorderFlow 3s linear infinite;
    }

    @keyframes topBorderFlow {
        0% { transform: translateX(-100%); }
        100% { transform: translateX(100%); }
    }

    .nav-btn {
        padding: 15px 30px;
        border-radius: 15px;
        font-weight: 700;
        font-size: 1rem;
        text-decoration: none;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        border: none;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 10px;
        position: relative;
        overflow: hidden;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .nav-btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
        transition: left 0.5s ease;
    }

    .nav-btn:hover::before {
        left: 100%;
    }

    .btn-secondary {
        background: rgba(255, 255, 255, 0.1);
        color: #cbd5e1;
        border: 2px solid rgba(255, 255, 255, 0.2);
        backdrop-filter: blur(10px);
    }

    .btn-secondary:hover {
        background: rgba(255, 255, 255, 0.15);
        border-color: rgba(255, 255, 255, 0.3);
        transform: translateY(-2px);
        text-decoration: none;
        color: #e2e8f0;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .btn-primary {
        background: linear-gradient(135deg, #00ff88, #00bfff);
        color: #000;
        border: 2px solid #00ff88;
        box-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
    }

    .btn-primary:hover {
        background: linear-gradient(135deg, #00bfff, #ff0080);
        border-color: #00bfff;
        transform: translateY(-3px) scale(1.05);
        text-decoration: none;
        color: #000;
        box-shadow: 0 15px 40px rgba(0, 255, 136, 0.4);
    }

    .btn-primary:disabled {
        background: rgba(100, 116, 139, 0.3);
        border-color: rgba(100, 116, 139, 0.3);
        color: #64748b;
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
    }

    .btn-primary:disabled:hover {
        transform: none;
        box-shadow: none;
    }

    #step-info {
        color: #94a3b8;
        font-size: 1rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 1px;
        text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
    }

    /* Loading and Error States */
    .loading-spinner {
        display: inline-block;
        width: 24px;
        height: 24px;
        border: 3px solid rgba(255, 255, 255, 0.1);
        border-top: 3px solid #00ff88;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        filter: drop-shadow(0 0 10px rgba(0, 255, 136, 0.5));
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    .error-message {
        background: rgba(255, 0, 128, 0.1);
        color: #ff0080;
        padding: 20px;
        border-radius: 15px;
        margin-bottom: 25px;
        border: 2px solid rgba(255, 0, 128, 0.3);
        backdrop-filter: blur(10px);
        font-weight: 600;
        box-shadow: 0 10px 30px rgba(255, 0, 128, 0.2);
    }

    /* Enhanced Responsive Design */
    @media (max-width: 768px) {
        .hero-title {
            font-size: 3rem;
        }

        .hero-features {
            gap: 20px;
            flex-direction: column;
            align-items: center;
        }

        .hero-feature {
            font-size: 0.9rem;
        }

        .prediction-card {
            margin: -30px 16px 30px;
            border-radius: 20px;
        }

        .step-content {
            padding: 30px 20px;
        }

        .symptom-categories {
            grid-template-columns: 1fr;
        }

        .patient-info-grid {
            grid-template-columns: 1fr;
        }

        .step-navigation {
            padding: 20px;
            flex-direction: column;
            gap: 15px;
        }

        .nav-btn {
            width: 100%;
            justify-content: center;
        }

        .recommendations {
            grid-template-columns: 1fr;
        }

        .content-title {
            font-size: 1.8rem;
        }

        .result-disease {
            font-size: 2rem;
        }
    }

    @media (max-width: 480px) {
        .hero-title {
            font-size: 2.5rem;
        }

        .symptom-categories {
            padding: 10px;
        }

        .symptom-category {
            padding: 20px 15px;
        }

        .symptom-grid {
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        }

        .step-content {
            padding: 20px 15px;
        }

        .prediction-result {
            padding: 25px 20px;
        }

        .result-icon {
            width: 60px;
            height: 60px;
            font-size: 2rem;
        }
    }

    /* Custom Info Box Styling */
    .info-box {
        background: rgba(0, 191, 255, 0.1);
        border: 2px solid rgba(0, 191, 255, 0.3);
        border-radius: 15px;
        padding: 25px;
        margin-top: 30px;
        max-width: 700px;
        margin-left: auto;
        margin-right: auto;
        backdrop-filter: blur(15px);
        box-shadow: 0 10px 30px rgba(0, 191, 255, 0.2);
    }

    .info-box-header {
        display: flex;
        align-items: center;
        gap: 15px;
        margin-bottom: 12px;
    }

    .info-box-header i {
        color: #00bfff;
        font-size: 1.4rem;
        text-shadow: 0 0 15px rgba(0, 191, 255, 0.5);
    }

    .info-box-header strong {
        color: #00bfff;
        font-weight: 800;
        font-size: 1.1rem;
        text-shadow: 0 0 10px rgba(0, 191, 255, 0.3);
    }

    .info-box ul {
        color: #cbd5e1;
        margin: 0;
        padding-left: 25px;
        line-height: 1.7;
    }

    .info-box li {
        margin-bottom: 8px;
        font-weight: 500;
    }

    /* Disclaimer Box */
    .disclaimer-box {
        background: rgba(255, 214, 10, 0.1);
        border: 2px solid rgba(255, 214, 10, 0.4);
        border-radius: 15px;
        padding: 25px;
        margin-top: 25px;
        backdrop-filter: blur(15px);
        box-shadow: 0 10px 30px rgba(255, 214, 10, 0.2);
    }

    .disclaimer-header {
        display: flex;
        align-items: center;
        gap: 15px;
        margin-bottom: 12px;
    }

    .disclaimer-header i {
        color: #ffd60a;
        font-size: 1.4rem;
        text-shadow: 0 0 15px rgba(255, 214, 10, 0.5);
    }

    .disclaimer-header strong {
        color: #ffd60a;
        font-weight: 800;
        font-size: 1.1rem;
        text-shadow: 0 0 10px rgba(255, 214, 10, 0.3);
    }

    .disclaimer-box p {
        color: #cbd5e1;
        margin: 0;
        line-height: 1.7;
        font-weight: 500;
    }

    /* Smooth scrollbar for symptoms container */
    .symptoms-container {
        scrollbar-width: thin;
        scrollbar-color: rgba(0, 255, 136, 0.3) rgba(255, 255, 255, 0.1);
    }

    .symptoms-container::-webkit-scrollbar {
        width: 8px;
    }

    .symptoms-container::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 4px;
    }

    .symptoms-container::-webkit-scrollbar-thumb {
        background: rgba(0, 255, 136, 0.3);
        border-radius: 4px;
        transition: background 0.3s ease;
    }

    .symptoms-container::-webkit-scrollbar-thumb:hover {
        background: rgba(0, 255, 136, 0.5);
    }
</style>

<div class="prediction-container">
    <!-- Hero Section -->
    <div class="hero-section">
        <h1 class="hero-title">⚡ AI Health Intelligence</h1>
        <p class="hero-subtitle">
            Experience the future of medical diagnosis with our cutting-edge AI technology. 
            Advanced neural networks analyze your symptoms to provide instant, accurate health predictions.
        </p>
        <div class="hero-features">
            <div class="hero-feature">
                <i class="fas fa-robot"></i>
                <span>Neural AI Analysis</span>
            </div>
            <div class="hero-feature">
                <i class="fas fa-brain"></i>
                <span>Smart Categorization</span>
            </div>
            <div class="hero-feature">
                <i class="fas fa-bolt"></i>
                <span>Lightning Fast</span>
            </div>
            <div class="hero-feature">
                <i class="fas fa-shield-alt"></i>
                <span>Medical Grade Security</span>
            </div>
        </div>
    </div>

    <!-- Main Prediction Card -->
    <div class="prediction-card">
        <!-- Step Progress -->
        <div class="step-progress">
            <div class="progress-step active" id="step-1">
                <div class="step-number">1</div>
                <div class="step-title">Patient Info</div>
            </div>
            <div class="progress-step" id="step-2">
                <div class="step-number">2</div>
                <div class="step-title">Select Symptoms</div>
            </div>
            <div class="progress-step" id="step-3">
                <div class="step-number">3</div>
                <div class="step-title">Get Results</div>
            </div>
        </div>

        <!-- Step 1: Patient Information -->
        <div class="step-content active" id="content-1">
            <div class="content-header">
                <h2 class="content-title">Tell Us About Yourself</h2>
                <p class="content-description">
                    Help us provide more accurate predictions by sharing some basic information about yourself.
                </p>
            </div>

            <div class="patient-info-grid">
                <div class="info-field">
                    <label for="patient-age">Age</label>
                    <input type="number" id="patient-age" placeholder="Enter your age" min="1" max="120">
                </div>
                <div class="info-field">
                    <label for="patient-gender">Gender</label>
                    <select id="patient-gender">
                        <option value="">Select gender</option>
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                        <option value="other">Other</option>
                    </select>
                </div>
            </div>

            <div class="info-box">
                <div class="info-box-header">
                    <i class="fas fa-info-circle"></i>
                    <strong>Why do we need this information?</strong>
                </div>
                <ul>
                    <li>Age and gender significantly influence symptom patterns and disease probability</li>
                    <li>Our AI model uses demographic data to enhance prediction accuracy by 23%</li>
                    <li>All information is encrypted and stored securely using military-grade encryption</li>
                    <li>Data is only used for prediction purposes and never shared with third parties</li>
                </ul>
            </div>
        </div>

        <!-- Step 2: Symptom Selection -->
        <div class="step-content" id="content-2">
            <div class="content-header">
                <h2 class="content-title">Select Your Symptoms</h2>
                <p class="content-description">
                    Choose the symptoms you're experiencing from the organized categories below. 
                    The more accurate your selection, the better our prediction will be.
                </p>
            </div>

            <div class="symptoms-container">
                <!-- Search Bar -->
                <div class="symptom-search">
                    <i class="fas fa-search"></i>
                    <input type="text" id="symptom-search-input" placeholder="Search for specific symptoms...">
                </div>

                <!-- Selected Symptoms -->
                <div class="selected-symptoms" id="selected-symptoms" style="display: none;">
                    <div class="selected-title">
                        <i class="fas fa-check-circle" style="color: #10b981;"></i>
                        Selected Symptoms
                    </div>
                    <div class="selected-list" id="selected-list"></div>
                </div>

                <!-- Symptom Categories -->
                <div class="symptom-categories">
                    <!-- Respiratory -->
                    <div class="symptom-category">
                        <div class="category-header">
                            <div class="category-icon respiratory">
                                <i class="fas fa-lungs"></i>
                            </div>
                            <div class="category-title">Respiratory System</div>
                        </div>
                        <div class="symptom-grid">
                            <div class="symptom-option" data-symptom="cough">Cough</div>
                            <div class="symptom-option" data-symptom="breathlessness">Breathlessness</div>
                            <div class="symptom-option" data-symptom="continuous_sneezing">Continuous Sneezing</div>
                            <div class="symptom-option" data-symptom="chest_pain">Chest Pain</div>
                            <div class="symptom-option" data-symptom="runny_nose">Runny Nose</div>
                            <div class="symptom-option" data-symptom="congestion">Congestion</div>
                            <div class="symptom-option" data-symptom="sputum">Sputum</div>
                            <div class="symptom-option" data-symptom="throat_irritation">Throat Irritation</div>
                        </div>
                    </div>

                    <!-- Gastrointestinal -->
                    <div class="symptom-category">
                        <div class="category-header">
                            <div class="category-icon gastrointestinal">
                                <i class="fas fa-stomach"></i>
                            </div>
                            <div class="category-title">Gastrointestinal</div>
                        </div>
                        <div class="symptom-grid">
                            <div class="symptom-option" data-symptom="vomiting">Vomiting</div>
                            <div class="symptom-option" data-symptom="nausea">Nausea</div>
                            <div class="symptom-option" data-symptom="diarrhoea">Diarrhoea</div>
                            <div class="symptom-option" data-symptom="loss_of_appetite">Loss of Appetite</div>
                            <div class="symptom-option" data-symptom="abdominal_pain">Abdominal Pain</div>
                            <div class="symptom-option" data-symptom="stomach_pain">Stomach Pain</div>
                            <div class="symptom-option" data-symptom="acidity">Acidity</div>
                            <div class="symptom-option" data-symptom="indigestion">Indigestion</div>
                            <div class="symptom-option" data-symptom="constipation">Constipation</div>
                            <div class="symptom-option" data-symptom="passage_of_gases">Passage of Gases</div>
                            <div class="symptom-option" data-symptom="internal_itching">Internal Itching</div>
                            <div class="symptom-option" data-symptom="ulcers_on_tongue">Ulcers on Tongue</div>
                        </div>
                    </div>

                    <!-- Neurological -->
                    <div class="symptom-category">
                        <div class="category-header">
                            <div class="category-icon neurological">
                                <i class="fas fa-brain"></i>
                            </div>
                            <div class="category-title">Neurological</div>
                        </div>
                        <div class="symptom-grid">
                            <div class="symptom-option" data-symptom="headache">Headache</div>
                            <div class="symptom-option" data-symptom="dizziness">Dizziness</div>
                            <div class="symptom-option" data-symptom="loss_of_balance">Loss of Balance</div>
                            <div class="symptom-option" data-symptom="lack_of_concentration">Lack of Concentration</div>
                            <div class="symptom-option" data-symptom="visual_disturbances">Visual Disturbances</div>
                            <div class="symptom-option" data-symptom="altered_sensorium">Altered Sensorium</div>
                            <div class="symptom-option" data-symptom="weakness_of_one_body_side">Weakness of One Body Side</div>
                            <div class="symptom-option" data-symptom="loss_of_smell">Loss of Smell</div>
                            <div class="symptom-option" data-symptom="blurred_and_distorted_vision">Blurred Vision</div>
                            <div class="symptom-option" data-symptom="spinning_movements">Spinning Movements</div>
                        </div>
                    </div>

                    <!-- Skin & External -->
                    <div class="symptom-category">
                        <div class="category-header">
                            <div class="category-icon skin">
                                <i class="fas fa-hand-paper"></i>
                            </div>
                            <div class="category-title">Skin & External</div>
                        </div>
                        <div class="symptom-grid">
                            <div class="symptom-option" data-symptom="itching">Itching</div>
                            <div class="symptom-option" data-symptom="skin_rash">Skin Rash</div>
                            <div class="symptom-option" data-symptom="nodal_skin_eruptions">Nodal Skin Eruptions</div>
                            <div class="symptom-option" data-symptom="dischromic_patches">Dischromic Patches</div>
                            <div class="symptom-option" data-symptom="yellowish_skin">Yellowish Skin</div>
                            <div class="symptom-option" data-symptom="yellowing_of_eyes">Yellowing of Eyes</div>
                            <div class="symptom-option" data-symptom="sweating">Sweating</div>
                            <div class="symptom-option" data-symptom="pus_filled_pimples">Pus Filled Pimples</div>
                            <div class="symptom-option" data-symptom="scurring">Scurring</div>
                            <div class="symptom-option" data-symptom="skin_peeling">Skin Peeling</div>
                            <div class="symptom-option" data-symptom="silver_like_dusting">Silver Like Dusting</div>
                            <div class="symptom-option" data-symptom="small_dents_in_nails">Small Dents in Nails</div>
                            <div class="symptom-option" data-symptom="inflammatory_nails">Inflammatory Nails</div>
                        </div>
                    </div>

                    <!-- General/Systemic -->
                    <div class="symptom-category">
                        <div class="category-header">
                            <div class="category-icon general">
                                <i class="fas fa-thermometer-half"></i>
                            </div>
                            <div class="category-title">General/Systemic</div>
                        </div>
                        <div class="symptom-grid">
                            <div class="symptom-option" data-symptom="fever">Fever</div>
                            <div class="symptom-option" data-symptom="chills">Chills</div>
                            <div class="symptom-option" data-symptom="fatigue">Fatigue</div>
                            <div class="symptom-option" data-symptom="weakness_in_limbs">Weakness in Limbs</div>
                            <div class="symptom-option" data-symptom="high_fever">High Fever</div>
                            <div class="symptom-option" data-symptom="dehydration">Dehydration</div>
                            <div class="symptom-option" data-symptom="fast_heart_rate">Fast Heart Rate</div>
                            <div class="symptom-option" data-symptom="muscle_weakness">Muscle Weakness</div>
                            <div class="symptom-option" data-symptom="malaise">Malaise</div>
                            <div class="symptom-option" data-symptom="shivering">Shivering</div>
                            <div class="symptom-option" data-symptom="unsteadiness">Unsteadiness</div>
                            <div class="symptom-option" data-symptom="continuous_feel_of_urine">Continuous Feel of Urine</div>
                        </div>
                    </div>

                    <!-- Musculoskeletal -->
                    <div class="symptom-category">
                        <div class="category-header">
                            <div class="category-icon musculoskeletal">
                                <i class="fas fa-bone"></i>
                            </div>
                            <div class="category-title">Musculoskeletal</div>
                        </div>
                        <div class="symptom-grid">
                            <div class="symptom-option" data-symptom="joint_pain">Joint Pain</div>
                            <div class="symptom-option" data-symptom="muscle_pain">Muscle Pain</div>
                            <div class="symptom-option" data-symptom="neck_pain">Neck Pain</div>
                            <div class="symptom-option" data-symptom="knee_pain">Knee Pain</div>
                            <div class="symptom-option" data-symptom="hip_joint_pain">Hip Joint Pain</div>
                            <div class="symptom-option" data-symptom="stiff_neck">Stiff Neck</div>
                            <div class="symptom-option" data-symptom="swelling_joints">Swelling Joints</div>
                            <div class="symptom-option" data-symptom="movement_stiffness">Movement Stiffness</div>
                            <div class="symptom-option" data-symptom="painful_walking">Painful Walking</div>
                            <div class="symptom-option" data-symptom="muscle_wasting">Muscle Wasting</div>
                        </div>
                    </div>

                    <!-- Urinary -->
                    <div class="symptom-category">
                        <div class="category-header">
                            <div class="category-icon urinary">
                                <i class="fas fa-tint"></i>
                            </div>
                            <div class="category-title">Urinary System</div>
                        </div>
                        <div class="symptom-grid">
                            <div class="symptom-option" data-symptom="burning_micturition">Burning Micturition</div>
                            <div class="symptom-option" data-symptom="spotting_urination">Spotting Urination</div>
                            <div class="symptom-option" data-symptom="dark_urine">Dark Urine</div>
                            <div class="symptom-option" data-symptom="polyuria">Polyuria</div>
                            <div class="symptom-option" data-symptom="bladder_discomfort">Bladder Discomfort</div>
                            <div class="symptom-option" data-symptom="foul_smell_of_urine">Foul Smell of Urine</div>
                        </div>
                    </div>

                    <!-- Mental/Cognitive -->
                    <div class="symptom-category">
                        <div class="category-header">
                            <div class="category-icon mental">
                                <i class="fas fa-head-side-virus"></i>
                            </div>
                            <div class="category-title">Mental/Cognitive</div>
                        </div>
                        <div class="symptom-grid">
                            <div class="symptom-option" data-symptom="irritability">Irritability</div>
                            <div class="symptom-option" data-symptom="mood_swings">Mood Swings</div>
                            <div class="symptom-option" data-symptom="restlessness">Restlessness</div>
                            <div class="symptom-option" data-symptom="lethargy">Lethargy</div>
                            <div class="symptom-option" data-symptom="anxiety">Anxiety</div>
                            <div class="symptom-option" data-symptom="depression">Depression</div>
                            <div class="symptom-option" data-symptom="confusion">Confusion</div>
                            <div class="symptom-option" data-symptom="coma">Coma</div>
                        </div>
                    </div>

                    <!-- Eyes & Vision -->
                    <div class="symptom-category">
                        <div class="category-header">
                            <div class="category-icon respiratory">
                                <i class="fas fa-eye"></i>
                            </div>
                            <div class="category-title">Eyes & Vision</div>
                        </div>
                        <div class="symptom-grid">
                            <div class="symptom-option" data-symptom="watering_from_eyes">Watering from Eyes</div>
                            <div class="symptom-option" data-symptom="sunken_eyes">Sunken Eyes</div>
                            <div class="symptom-option" data-symptom="excessive_hunger">Excessive Hunger</div>
                            <div class="symptom-option" data-symptom="increased_appetite">Increased Appetite</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Step 3: Results -->
        <div class="step-content" id="content-3">
            <div class="content-header">
                <h2 class="content-title">Prediction Results</h2>
                <p class="content-description">
                    Based on your symptoms, here's our AI-powered analysis and recommendations.
                </p>
            </div>

            <div class="results-container">
                <div id="loading-message" style="text-align: center; display: none;">
                    <div class="loading-spinner" style="margin: 0 auto 16px;"></div>
                    <p style="color: #64748b;">Analyzing your symptoms...</p>
                </div>

                <div id="error-message" class="error-message" style="display: none;">
                    <i class="fas fa-exclamation-triangle"></i>
                    <span></span>
                </div>

                <div id="prediction-results" style="display: none;">
                    <!-- Results will be populated here -->
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="step-navigation">
            <button class="nav-btn btn-secondary" id="prev-btn" onclick="previousStep()">
                <i class="fas fa-chevron-left"></i>
                Previous
            </button>

            <div style="color: #64748b; font-size: 0.9rem;" id="step-info">
                Step 1 of 3
            </div>

            <button class="nav-btn btn-primary" id="next-btn" onclick="nextStep()">
                Next
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
    </div>
</div>

<script>
let currentStep = 1;
let selectedSymptoms = [];

// Initialize the page
document.addEventListener('DOMContentLoaded', function() {
    updateNavigation();
    initializeSymptomSelection();
    initializeSearch();
});

function updateNavigation() {
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');
    const stepInfo = document.getElementById('step-info');

    prevBtn.style.display = currentStep === 1 ? 'none' : 'flex';
    stepInfo.textContent = `Step ${currentStep} of 3`;

    if (currentStep === 3) {
        nextBtn.textContent = 'Start Over';
        nextBtn.innerHTML = '<i class="fas fa-redo"></i> Start Over';
    } else {
        nextBtn.innerHTML = 'Next <i class="fas fa-chevron-right"></i>';
    }

    // Update button states
    if (currentStep === 1) {
        const age = document.getElementById('patient-age').value;
        const gender = document.getElementById('patient-gender').value;
        nextBtn.disabled = !age || !gender;
    } else if (currentStep === 2) {
        nextBtn.disabled = selectedSymptoms.length === 0;
    } else {
        nextBtn.disabled = false;
    }
}

function nextStep() {
    if (currentStep === 3) {
        // Start over
        currentStep = 1;
        selectedSymptoms = [];
        document.getElementById('patient-age').value = '';
        document.getElementById('patient-gender').value = '';
        updateSelectedSymptoms();
        showStep(currentStep);
        return;
    }

    if (currentStep === 1) {
        // Validate patient info
        const age = document.getElementById('patient-age').value;
        const gender = document.getElementById('patient-gender').value;
        if (!age || !gender) {
            alert('Please fill in all required information.');
            return;
        }
    }

    if (currentStep === 2) {
        // Validate symptoms
        if (selectedSymptoms.length === 0) {
            alert('Please select at least one symptom.');
            return;
        }
        // Make prediction
        makePrediction();
    }

    currentStep++;
    showStep(currentStep);
}

function previousStep() {
    if (currentStep > 1) {
        currentStep--;
        showStep(currentStep);
    }
}

function showStep(step) {
    // Hide all content
    document.querySelectorAll('.step-content').forEach(content => {
        content.classList.remove('active');
    });

    // Hide all progress steps
    document.querySelectorAll('.progress-step').forEach(progress => {
        progress.classList.remove('active', 'completed');
    });

    // Show current content
    document.getElementById(`content-${step}`).classList.add('active');

    // Update progress
    for (let i = 1; i <= 3; i++) {
        const stepElement = document.getElementById(`step-${i}`);
        if (i < step) {
            stepElement.classList.add('completed');
        } else if (i === step) {
            stepElement.classList.add('active');
        }
    }

    updateNavigation();
}

function initializeSymptomSelection() {
    document.querySelectorAll('.symptom-option').forEach(option => {
        option.addEventListener('click', function() {
            const symptom = this.dataset.symptom;
            toggleSymptom(symptom, this);
        });
    });

    // Add event listeners for patient info fields
    document.getElementById('patient-age').addEventListener('input', updateNavigation);
    document.getElementById('patient-gender').addEventListener('change', updateNavigation);
}

function toggleSymptom(symptom, element) {
    const index = selectedSymptoms.indexOf(symptom);
    
    if (index > -1) {
        // Remove symptom
        selectedSymptoms.splice(index, 1);
        element.classList.remove('selected');
    } else {
        // Add symptom
        selectedSymptoms.push(symptom);
        element.classList.add('selected');
    }

    updateSelectedSymptoms();
    updateNavigation();
}

function updateSelectedSymptoms() {
    const container = document.getElementById('selected-symptoms');
    const list = document.getElementById('selected-list');

    if (selectedSymptoms.length === 0) {
        container.style.display = 'none';
        return;
    }

    container.style.display = 'block';
    list.innerHTML = '';

    selectedSymptoms.forEach(symptom => {
        const tag = document.createElement('div');
        tag.className = 'selected-symptom';
        tag.innerHTML = `
            ${symptom.replace(/_/g, ' ')}
            <span class="remove" onclick="removeSymptom('${symptom}')">&times;</span>
        `;
        list.appendChild(tag);
    });
}

function removeSymptom(symptom) {
    const index = selectedSymptoms.indexOf(symptom);
    if (index > -1) {
        selectedSymptoms.splice(index, 1);
        
        // Update UI
        document.querySelector(`[data-symptom="${symptom}"]`).classList.remove('selected');
        updateSelectedSymptoms();
        updateNavigation();
    }
}

function initializeSearch() {
    const searchInput = document.getElementById('symptom-search-input');
    
    searchInput.addEventListener('input', function() {
        const query = this.value.toLowerCase();
        
        document.querySelectorAll('.symptom-option').forEach(option => {
            const symptomText = option.textContent.toLowerCase();
            const symptomData = option.dataset.symptom.toLowerCase();
            
            if (symptomText.includes(query) || symptomData.includes(query)) {
                option.style.display = 'block';
                option.parentElement.parentElement.style.display = 'block';
            } else {
                option.style.display = 'none';
            }
        });

        // Hide categories if no symptoms are visible
        document.querySelectorAll('.symptom-category').forEach(category => {
            const visibleSymptoms = category.querySelectorAll('.symptom-option[style*="block"], .symptom-option:not([style*="none"])');
            if (query && visibleSymptoms.length === 0) {
                category.style.display = 'none';
            } else {
                category.style.display = 'block';
            }
        });
    });
}

async function makePrediction() {
    const loadingMessage = document.getElementById('loading-message');
    const errorMessage = document.getElementById('error-message');
    const resultsContainer = document.getElementById('prediction-results');

    // Show loading
    loadingMessage.style.display = 'block';
    errorMessage.style.display = 'none';
    resultsContainer.style.display = 'none';

    try {
        const response = await fetch('/patients/predict-disease/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': getCookie('csrftoken')
            },
            body: JSON.stringify({
                symptoms: selectedSymptoms,
                age: document.getElementById('patient-age').value,
                gender: document.getElementById('patient-gender').value
            })
        });

        const data = await response.json();

        if (response.ok) {
            displayResults(data);
        } else {
            throw new Error(data.error || 'Prediction failed');
        }
    } catch (error) {
        console.error('Prediction error:', error);
        errorMessage.querySelector('span').textContent = error.message;
        errorMessage.style.display = 'block';
    } finally {
        loadingMessage.style.display = 'none';
    }
}

function displayResults(data) {
    const resultsContainer = document.getElementById('prediction-results');
    
    resultsContainer.innerHTML = `
        <div class="prediction-result">
            <div class="result-icon">
                <i class="fas fa-stethoscope"></i>
            </div>
            <div class="result-title">Predicted Condition</div>
            <div class="result-disease">${data.predicted_disease || 'Unknown'}</div>
            <div class="result-confidence">
                Confidence: ${data.confidence ? Math.round(data.confidence * 100) : 'N/A'}%
            </div>
            
            ${data.medicine_recommendation || data.diet_recommendation ? `
                <div class="recommendations">
                    ${data.medicine_recommendation ? `
                        <div class="recommendation-card">
                            <div class="recommendation-header">
                                <div class="recommendation-icon medicine-icon">
                                    <i class="fas fa-pills"></i>
                                </div>
                                <div class="recommendation-title">Medicine Recommendation</div>
                            </div>
                            <div class="recommendation-content">${data.medicine_recommendation}</div>
                        </div>
                    ` : ''}
                    
                    ${data.diet_recommendation ? `
                        <div class="recommendation-card">
                            <div class="recommendation-header">
                                <div class="recommendation-icon diet-icon">
                                    <i class="fas fa-apple-alt"></i>
                                </div>
                                <div class="recommendation-title">Diet Recommendation</div>
                            </div>
                            <div class="recommendation-content">${data.diet_recommendation}</div>
                        </div>
                    ` : ''}
                </div>
            ` : ''}
        </div>
        
        <div class="disclaimer-box">
            <div class="disclaimer-header">
                <i class="fas fa-exclamation-triangle"></i>
                <strong>Medical Disclaimer</strong>
            </div>
            <p>
                This AI prediction system is designed for informational and educational purposes only. 
                It should never replace professional medical consultation, diagnosis, or treatment. 
                Always consult with qualified healthcare professionals for medical advice and emergency situations.
            </p>
        </div>
    `;
    
    resultsContainer.style.display = 'block';
}

function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}
</script>
{% endblock %}